<!-- Fix the twice print of the product items
Fix the login if index is hit then it shouod check login first and provide login period 
Firebase few data are missing so send them -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfume & Cosmetics Store</title>
    <!-- Add your CSS links here -->
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

</head>
<body>

   

    <!-- Header section -->
    <header>
        <div class="search-container">
            <form id="searchForm" action="#" method="GET"> <!-- Update form action -->
                <input type="text" id="searchInput" placeholder="Search products..." name="search">
                <button type="submit"><i class="fa fa-search"></i></button>
            </form>
        </div>
        
        
        <div class="profile-logo">
            
            <a href="profile.html">
                <i class="fas fa-user-circle"></i>
            </a>
         
        </div>
        <!-- logo -->
        <div class="title">
            <img src="img/Logo.jpg" alt="Ardior Logo">
        </div>
    
        <!-- Search bar -->
     
    
        <div class="navlink">
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="shopping.html">Products</a></li>
                    <li><a href="aboutus.html">About Us</a></li>
                    <li><a href="cart.html">cart</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    

    <!-- Main content section -->
    <main>
        <section class="hero">
            <h3>Welcome to our Perfume & Cosmetics Store</h3>
            <div class="hero-image">
                <img src="img/Home.png" alt="Perfume & Cosmetics Store">
            </div>
            <a href="shopping.html" class="btn">Shop Now</a>
        </section>
        <h2>Featured Products</h2>
       
       
        <section class="products">
            <!-- Product 1 -->
            <div class="product" id="product1">
                <h3 id="productName1">Perfume Name1</h3>
                <p id="productPrice1">$4</p>
                <button class="add-to-cart" data-id="1">Add to Cart</button>
            </div>
    
            <!-- Product 2 -->
            <div class="product" id="product2">
                <h3 id="productName2">Perfume Name2</h3>
                <p id="productPrice2">$7</p>
                <button class="add-to-cart" data-id="2">Add to Cart</button>
            </div>
    
            <!-- Product 3 -->
            <div class="product" id="product3">
                <h3 id="productName3">Dior</h3>
                <p id="productPrice3">$6</p>
                <button class="add-to-cart" data-id="3">Add to Cart</button>
            </div>
            <!-- Add more products as needed -->
        </section>
    </main>

    <!-- Footer section -->
    <footer>
        <div class="logo">
            <h1>Perfume & Cosmetics Store</h1>
        </div>
        <nav>
      
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="shopping.html">Products</a></li>
                    <li><a href="aboutus.html">About Us</a></li>
                    <li><a href="cart.html">cart</a></li>
                </ul>
            
        </nav>
        <p>&copy; 2024 Perfume & Cosmetics Store. All rights reserved.</p>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA0HQ-OBjuy39U4I5e2sHW_6scyrbvshgA",
            authDomain: "perfume-3c5fa.firebaseapp.com",
            databaseURL: "https://perfume-3c5fa-default-rtdb.firebaseio.com",
            projectId: "perfume-3c5fa",
            storageBucket: "perfume-3c5fa.appspot.com",
            messagingSenderId: "271666106212",
            appId: "1:271666106212:web:78f54192781bdd1b887471"
        };
        const firebaseApp = initializeApp(firebaseConfig);

        // Reference to Firebase authentication
        const auth = getAuth(firebaseApp);

        // Function to log in to an existing account
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            signInWithEmailAndPassword(auth, email, password)
                .then(() => {
                    document.getElementById('loginMessage').textContent = "Login successful!";
                    clearForm('loginForm');
                    console.log("Redirecting to index.html..."); // Add this line for debugging
                    // Redirect to index.html upon successful login
                    window.location.href = 'index.html';
                })
                .catch(error => {
                    document.getElementById('loginMessage').textContent = error.message;
                });
        }

        // Function to clear form fields
        function clearForm(formId) {
            const form = document.getElementById(formId);
            const inputs = form.getElementsByTagName('input');
            for (let i = 0; i < inputs.length; i++) {
                inputs[i].value = '';
            }
        }

        // Adding event listener to login button after the function definition
        document.getElementById('loginButton').addEventListener('click', login);

    </script>

    <script>
document.addEventListener('DOMContentLoaded', function() {
        const addToCartButtons = document.querySelectorAll('.add-to-cart');
        addToCartButtons.forEach(button => {
            button.addEventListener('click', function() {
                const name = this.getAttribute('data-name');
                const price = parseFloat(this.getAttribute('data-price'));
                
                // Retrieve existing cart items from localStorage
                let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
                
                // Check if the item is already in the cart
                const existingItemIndex = cartItems.findIndex(item => item.name === name);
                if (existingItemIndex !== -1) {
                    // If the item already exists in the cart, update its quantity
                    cartItems[existingItemIndex].quantity++;
                } else {
                    // If the item is not in the cart, add it as a new item
                    cartItems.push({ name: name, price: price, quantity: 1 });
                }
                
                // Save the updated cart items back to localStorage
                localStorage.setItem('cartItems', JSON.stringify(cartItems));
                
                // Redirect the user to the cart page
                window.location.href = 'cart.html';
            });
        });
    });
    </script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Function to fetch product data from the server
        function fetchProductData(productId) {
            fetch(`/product/${productId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Product not found'); // Throw custom error message for 404
                    }
                    return response.json();
                })
                .then(data => {
                    // Handle the product data received from the server
                    console.log(data);
                    // Update your HTML dynamically with the product data
                })
                .catch(error => {
                    console.error('Error fetching product data:', error.message);
                });
        }

        // Add event listeners or other JavaScript logic as needed
        // For example, when a user clicks on a product link:
        document.getElementById('product1').addEventListener('click', function() {
            fetchProductData('1');
        });

        // Repeat the above for other product links/buttons
    });
</script>
</body>
</html>

